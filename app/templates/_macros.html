{% macro button(field) %}
  {{ field(class="btn btn-primary", **kwargs) | safe}}
{% endmacro%}

{% macro cancel_button() %}
  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
{% endmacro%}

{% macro flash_message(category)%}
<!-- Flash message -->
{% with messages = get_flashed_messages(with_categories=true, category_filter=category) %}
  {% if messages %}
    {% for category, message in messages %}
    <div class="col-auto mx-5 my-2">
    <div class="alert alert-warning alert-dismissible fade show {{category}}" role="alert" >
      <small>{{ message }}</small>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    </div>
    {% endfor %}
  {% endif %}
{% endwith %}
{% endmacro%}

{% macro field(field) %}
  {% if field.errors %}
  {% set css_class='is-invalid' + kwargs.pop('class','') %}  
  {{ field(class=css_class,**kwargs)|safe }}
    <div class="invalid-feedback">
    {% for error in field.errors %}
      {{ error }}
    {% endfor %}
    </div>
  {% else %}
    {{ field(**kwargs)|safe }}
  {% endif %}
{% endmacro %}

{% macro make_input(id,size,selkey='',type='text', class='') %}
  {% if not selfkey %}{% set selkey=id%}{%endif%}
  {% if selfkey == 'tl_interval'%}
    {% if selfkey in g.raspiconfig%}
      {% set value=g.raspiconfig[selkey]/10 %}
    {% else %}
      {% set value=3 %}
    {%endif%}
  {%elif selfkey == 'watchdog_interval'%}
    {% if selfkey in g.raspiconfig%}
      {% set value=g.raspiconfig[selkey]/10 %}
    {% else %}
      {% set value=0 %}
    {%endif%}
  {%else%}
    {% set value=g.raspiconfig[selkey] %}
  {% endif %}
  <input type="{{type}}" id="{{id}}" value="{{value}}" class="form-control form-control-sm {{class}}">
{% endmacro%}

{% macro make_options(options,selkey) %}
  {% if selfkey == 'flip'%}
      {% if config['vflip'] == 1 %}{% set vflip=2%}{%else%}{% set vflip=2%}{%endif%}
      {% if config['hflip'] == 1 %}{% set hflip=1%}{%else%}{% set hflip=0%}{%endif%}   
      {% set cvalue=vflip+hflip%}
  {%elif selfkey == 'MP4Box'%}
      {% set cvalue=g.raspiconfig[selKey]%}
      {% if cvalue == 'background'%}{%set cvalue = 2%}{%endif%}
  {%else%}
    {% set cvalue=g.raspiconfig[selkey] %}
  {% endif %}

  {% if cvalue == 'false'%}{% set cvalue=0%}{% elif cvalue == 'true'%}{% set cvalue=1%}{%endif%}
  {% for name,value in options.items()%}
    {% if cvalue != value %}{% set selected=''%}{%else%}{% set selected='selected'%}{%endif%}
    <option value='{{value}}' {{selected}}>{{name}}</option>
  {%endfor%}
{% endmacro%}